<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <!-- CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <!-- 테마 -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
    <!-- 자바스크립트 -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    
    <link rel="icon" href="static/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="static/styles/main.css">
    <title>3D 창고 시뮬레이션</title>

    <style>
      .error-text {
          color: red;
      }
      
    </style>

  </head>

  <body>

  <!-- 모달 -->
  <div class="modal" id="myModal">
      <div class="modal-dialog">
          <div class="modal-content">

            <!-- 모달 헤더 -->
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h4 class="modal-title" style="text-align: center;">특이사항</h4>
            </div>

            <!-- 모달 본문 -->
            <div class="modal-body">
                <input type="text" id="title" name="title" placeholder="제목을 입력하세요." autocomplete="off"/><br><br>
                <textarea rows="4" cols="50" id="bigo" name="bigo" placeholder="내용을 입력하세요." autocomplete="off"></textarea>
            </div>

            <!-- 모달 푸터 -->
            <div class="modal-footer">
                <button type="button" class="btn btn-success" id="btnModalSave">저장</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
            </div>

          </div>
      </div>
  </div>


    <h3 style="text-align: center; display: block;">3D 창고 시뮬레이션</h3>
    
      <div style="text-align: right;">
        <button id="btnNon" class="btn btn-light">논</button>
        <button id="btnVessel" class="btn btn-light">선박</button>
      </div>
    
      <div>
        가로 : <input type="text" id="width" name="width" style="text-align: right" placeholder="가로를 입력하세요." autocomplete="off"/><span class="error-text"></span><br>
        세로 : <input type="text" id="height" name="height" style="text-align: right" placeholder="세로를 입력하세요." autocomplete="off"/><span class="error-text"></span><br>
        높이 : <input type="text" id="vertical" name="vertical" style="text-align: right" placeholder="높이를 입력하세요." autocomplete="off"/><span class="error-text"></span><br>
        X축&nbsp; : <input type="text" id="x_chuk" name="x_chuk" style="text-align: right" placeholder="X축 좌표를 입력하세요." autocomplete="off"/><span class="error-text"></span><br>
        Y축&nbsp; : <input type="text" id="y_chuk" name="y_chuk" style="text-align: right" placeholder="y축 좌표를 입력하세요." autocomplete="off"/><span class="error-text"></span><br>
        Z축&nbsp; : <input type="text" id="z_chuk" name="z_chuk" style="text-align: right" placeholder="z축 좌표를 입력하세요." autocomplete="off"/><span class="error-text"></span><br><br>
        <button type="button" class="btn btn-success" id="btnTrans"> 적용 </button>
        <button type="button" class="btn btn-warning" id="btnPrev"> 이전 </button>
        <button type="button" class="btn btn-danger" id="btnReset"> 초기화 </button>
        <button type="button" class="btn btn-light" data-toggle="modal" data-target="#myModal">정보 입력</button>
        <button type="button" class="btn btn-primary" id="btnSave"> 저장 </button>
      </div>
    
    <script src="public/bundle.js"></script>
    <script src="src/index.js"></script>

  </body>

  <script>
    $(document).ready(function() {

      $("#width").focus();

      defaultPage();

  });
        

  // 유효성 검사
  $('input[type="text"]').on('blur', inputValid);

  // 적용 버튼
  $("#btnTrans").click(fnClickTrans);

  // 이전 버튼
  $("#btnPrev").click(fnClickPrev);

  // 초기화 버튼
  $("#btnReset").click(fnClickReset);

  // 저장 버튼
  $("#btnSave").click(fnClickSave);

  // 모달 저장 버튼 (실제 저장)
  $("#btnModalSave").click(fnClickModalSave);

  // 논 버튼
  $("#btnNon").click(fnChangeNon);

  // 선박 버튼
  $("#btnVessel").click(fnChangeVessel);


  function inputValid() {
    const inputVal = $(this).val();
    const errorText = $(this).next('.error-text');

    // 정규식 (숫자 1 ~ 9)
    var onlyNumber = /^[0-9]*$/;
    
    if(!onlyNumber.test(inputVal)){
      errorText.text(' 양의 정수를 입력하세요.');
    }else{
      errorText.text('');
    }
  }

  function fnClickTrans() {

    var width = $("#width").val();
    var height = $("#height").val();
    var vertical = $("#vertical").val();
    var x_chuk = $("#x_chuk").val();
    var y_chuk = $("#y_chuk").val();
    var z_chuk = $("#z_chuk").val();

    var valList = [ width, height, vertical, x_chuk, y_chuk, z_chuk ];

    setTransData(valList);

  }
  
  function fnClickPrev(){
    setPrevData();
  }

  function fnClickReset(){
    setResetData();
  }

  function fnClickSave(){
  
    // 이제 모달창 뜨게 소스짜야함

  }

  function fnClickModalSave(){

    // 겟요청 코드
    //  $.get('http://localhost:7000/api/data', function(data) {
    //   $('#result').text('백엔드로부터 받은 데이터: ' + data);
    // });

    const dataToSend = {
      title: $("#title").val(),
      bigo: $("#bigo").val(),
      width: $("#width").val(),
      height: $("#height").val(),
      vertical: $("#vertical").val(),
      x_chuk: $("#x_chuk").val(),
      y_chuk: $("#y_chuk").val(),
      z_chuk: $("#z_chuk").val()
    };

    console.log(dataToSend)

    $.ajax({
      type: "POST",
      url: "http://localhost:7000/api/data", // 백엔드 컨트롤러 URL
      data: JSON.stringify(dataToSend),
      contentType: 'application/json',
      success: function(data) {
        console.log("결과는 :" + data)
      }
    }); 

  }

  function fnChangeNon(){
    if($("#btnVessel").hasClass("btn btn-success")){
      $("#btnVessel").removeClass("btn btn-success").addClass("btn btn-light")
    }
    $("#btnNon").removeClass("btn btn-light").addClass("btn btn-success")

    init("non")
  }

  function fnChangeVessel(){
    if($("#btnNon").hasClass("btn btn-success")){
      $("#btnNon").removeClass("btn btn-success").addClass("btn btn-light")
    }
    $("#btnVessel").removeClass("btn btn-light").addClass("btn btn-success")

    init("vessel")
  }

 

</script>

</html>
